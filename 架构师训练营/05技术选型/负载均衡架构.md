# 技术选型

## 负载均衡

### 负载均衡架构

#### HTTP重定向负载均衡

优点: 实现简单
缺点：每次要经过两次HTTP通信

#### DNS负载均衡

不会带来多次网络通信带来的性能下降

#### 反向代理负载均衡

反向代理服务器要拿到完整的请求包，才能转发
性能要求，压力比较大
小规模服务器可以

#### IP负载均衡

改源目标IP地址
大量的数据包，网卡带宽成为瓶颈，响应的瓶颈

#### 数据链路层负载均衡

负载均衡服务器修改Mac地址，转发给应用服务器
降低负载均衡器的带宽和性能压力

### 负载均衡算法

- 轮询：所有请求被依次分发到每个应用服务器上，适合于所有服务器硬件都相同的场景。
- 加权轮询：根据应用服务器硬件性能的情况，在轮询的基础上，按照配置的权重将请求分发到每个服务器，高性能的服务器分配更多请求。
- 随机：请求被随机分配到各个应用服务器，在许多场合下，这种方案都很简单实用，因为好的随机数本身就很均衡。如果应用服务器硬件配置不同，也可以很容易的使用加权随机算法。
- 最少连接：记录每个应用服务器正在处理的连接数（请求数），将新到的请求分发到最少连接的服务器上，应该说，这是最符合负载均衡定义的算法。
- 源地址散列：根据请求来源的IP地址进行Hash计算，得到应用服务器，该算法可以保证同一个来源的请求总在同一个服务器上处理，实现会话粘滞。

### 应用服务器集群的Session管理

应用服务器的高可用架构设计主要基于服务无状态这一特性，但是事实上，业务总是有状态的，在交易类的电子商务网站，需要有购物车记录用户的购买信息，用户每次购买请求都是向购物车中增加商品；在社交类的网站中，需要记录用户的当前登录状态、最新发布的消息等以便及时将这些信息通知给他的好友。Web 应用中将这些状态信息称作会话（Session），单机情况下，Session 可交给Web 容器管理，在使用负载均衡的集群环境中，Session 管理主要有以下几种手段。

#### Session复制

#### session绑定

#### cookie记录session

#### Session服务器

分布式系统架构尽量实现无状态Share Nothing的这种集群架构
状态的管理用专门的服务器去管理
